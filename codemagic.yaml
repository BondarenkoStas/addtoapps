workflows:
    default-workflow:
      name: android_using_plugin
      environment:
        flutter: stable
        xcode: latest
        cocoapods: default
      triggering:
        events:
          - push
        branch_patterns:
          - pattern: 'android_using_plugin'
            include: true
            source: true
      scripts:
        - |
          # set up debug keystore
          rm -f ~/.android/debug.keystore
          keytool -genkeypair \
            -alias androiddebugkey \
            -keypass android \
            -keystore ~/.android/debug.keystore \
            -storepass android \
            -dname 'CN=Android Debug,O=Android,C=US' \
            -keyalg 'RSA' \
            -keysize 2048 \
            -validity 10000
        - |
          # set up local properties
          echo "flutter.sdk=$HOME/programs/flutter" > "$FCI_BUILD_DIR/android/local.properties"
        - flutter packages pub get
        - flutter build apk --debug
      artifacts:
        - build/**/outputs/**/*.apk
        - build/**/outputs/**/*.aab
        - build/**/outputs/**/mapping.txt
        - flutter_drive.log
      publishing:
        email:
          recipients:
            - bondarenko.stanislav.96@gmail.com
  